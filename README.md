# lean4-logic
Formalizing Logic in Lean4

https://iehality.github.io/lean4-logic/

## Table of Contents

- [lean4-logic](#lean4-logic)
  - [Table of Contents](#table-of-contents)
  - [Usage](#usage)
  - [Structure](#structure)
  - [Classical Propositional Logic](#classical-propositional-logic)
    - [Definition](#definition)
    - [Theorem](#theorem)
  - [Intuitionistic Propositional Logic](#intuitionistic-propositional-logic)
    - [Definitions](#definitions)
    - [Kripkean Semantics](#kripkean-semantics)
      - [Defininitions](#defininitions)
      - [Theorems](#theorems)
  - [First-Order Logic](#first-order-logic)
    - [Definition](#definition-1)
    - [Theorem](#theorem-1)
  - [Normal Modal Logic](#normal-modal-logic)
    - [Definition](#definition-2)
    - [Theorem](#theorem-2)
  - [References](#references)

## Usage
  Add following to `lakefile.lean`.
  ```lean
  require logic from git "https://github.com/iehality/lean4-logic"
  ```

## Structure

The key results are summarised in `Logic/Summary.lean`.

- **Logic**
  - **Vorspiel**: Supplementary definitions and theorems for Mathlib
  - **Logic**
  - **AutoProver**: Automated theorem proving based on proof search
  - **Propositional**: Propositional logic
    - **Classical**: Classical propositional logic
      - **Basic**
    - **Intuitionistic**: Intuitionistic propositional logic
      - **Kriple**: Kripke semantics
  - **FirstOrder**: First-order logic
    - **Basic**
    - **Computability**: encodeing, computability
    - **Completeness**: Completeness theorem
    - **Arith**: Arithmetic
    - **Incompleteness**: Incompleteness theorem
  - **Modal**: Variants of modal logics
    - **Normal**: Normal propositional modal logic

## Classical Propositional Logic

### Definition

|                                     |                                     | Definition                    | Notation |
| :----:                              | ----                                | ----                          | :----:   |
| $(\rm Cut)\vdash_\mathrm{T} \Gamma$ | Derivation in Tait-Calculus + Cut   | [LO.Propositional.Classical.Derivation](https://iehality.github.io/lean4-logic/Logic/Propositional/Classical/Basic/Calculus.html#LO.Propositional.Classical.Derivation) | `‚ä¢¬π Œì`   |
| $v \models p$                       | Tarski's truth definition condition | [LO.Propositional.Classical.semantics](https://iehality.github.io/lean4-logic/Logic/Propositional/Classical/Basic/Semantics.html#LO.Propositional.Classical.semantics) | `v ‚äß p`  |

### Theorem

- [Soundness theorem](https://iehality.github.io/lean4-logic/Logic/Propositional/Classical/Basic/Completeness.html#LO.Propositional.Classical.soundness)
  ```lean
  theorem LO.Propositional.Classical.soundness
    {Œ± : Type u_1}
    {T : LO.Propositional.Theory Œ±}
    {p : LO.Propositional.Formula Œ±} :
    T ‚ä¢ p ‚Üí T ‚ä® p
  ```

- [Completeness theorem](https://iehality.github.io/lean4-logic/Logic/Propositional/Classical/Basic/Completeness.html#LO.Propositional.Classical.completeness)
  ```lean
  noncomputable def LO.Propositional.Classical.completeness
      {Œ± : Type u_1}
      {T : LO.Propositional.Theory Œ±}
      {p : LO.Propositional.Formula Œ±} :
      T ‚ä® p ‚Üí T ‚ä¢ p
  ```

## Intuitionistic Propositional Logic

### Definitions

|                                   |                                            | Definition                                 |   Notation   |
| :-------------------------------: | ------------------------------------------ | :----------------------------------------- | :----------: |
| $\Gamma \vdash \varphi$       | Deduction„ÄÄ | LO.Propositional.Intuitionistic.Deduction | `Œì ‚ä¢·¥µ p` |
| | Deductive (Exists deduction) | LO.Propositional.Intuitionistic.Deductive | `Œì ‚ä¢·¥µ! p` |

### Kripkean Semantics

#### Defininitions

|                                   |                                            | Definition                                 |   Notation   |
| :-------------------------------: | ------------------------------------------ | :----------------------------------------- | :----------: |
| $w \Vdash^M \varphi$       | Satisfy on Kripkean Model $M$ and its world $w$„ÄÄ | LO.Propositional.Intuitionistic.Formula.KripkeSatisfies | `w ‚ä©[M] p` |
| $M \vDash \varphi$        | Models                    | LO.Propositional.Intuitionistic.Formula.KripkeModels |  `M ‚äß p`  |
| $\Gamma \models \varphi$        | Conequences                    | LO.Propositional.Intuitionistic.Formula.KripkeConsequence |  `Œì ‚ä®·¥µ p`  |

#### Theorems
- [Soundness](https://iehality.github.io/lean4-logic/Logic/Propositional/Intuitionistic/Kripke/Soundness.html#LO.Propositional.Intuitionistic.Kripke.sounds)
  ```lean
  theorem Kripke.sounds {Œì : Theory Œ≤} {p : Formula Œ≤} : (Œì ‚ä¢·¥µ! p) ‚Üí (Œì ‚ä®·¥µ p)
  ```
- [Completeness](https://iehality.github.io/lean4-logic/Logic/Propositional/Intuitionistic/Kripke/Completeness.html#LO.Propositional.Intuitionistic.Kripke.completes)
  ```lean
  theorem Kripke.completes
    [DecidableEq Œ≤] [Encodable Œ≤]
    {Œì : Theory Œ≤} {p : Formula Œ≤} : (Œì ‚ä®·¥µ p) ‚Üí (Œì ‚ä¢·¥µ! p)
  ```
- [Disjunction Property](https://iehality.github.io/lean4-logic/Logic/Propositional/Intuitionistic/Kripke/Completeness.html#LO.Propositional.Intuitionistic.Deduction.disjunctive)
  ```lean
  theorem Deduction.disjunctive
    [DecidableEq Œ≤] [Encodable Œ≤]
    {p q : Formula Œ≤} : (‚àÖ ‚ä¢·¥µ! p ‚ãé q) ‚Üí (‚àÖ ‚ä¢·¥µ! p) ‚à® (‚àÖ ‚ä¢·¥µ! q)
  ```

## First-Order Logic

$\mathbf{PA^-}$ is not to be included in $\mathbf{I\Sigma}_n$ or $\mathbf{PA}$ for simplicity in this formalization.

### Definition
|                                     |                                                | Definition                 | Notation |
| :----:                              | ----                                           | ----                       | :----:   |
| $(\rm Cut)\vdash_\mathrm{T} \Gamma$ | Derivation in Tait-Calculus + Cut              | [LO.FirstOrder.Derivation](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Basic/Calculus.html#LO.FirstOrder.Derivation) | `‚ä¢¬π Œì`   |
| $M \models \sigma$                  | Tarski's truth definition condition            | [LO.FirstOrder.Models](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Basic/Semantics/Semantics.html#LO.FirstOrder.Models) | `M ‚äß‚Çò œÉ` |
| $\mathbf{Eq}$                       | Axiom of equality                              | [LO.FirstOrder.Theory.Eq](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Basic/Eq.html#LO.FirstOrder.Theory.Eq) | `ùêÑùê™` |
| $\mathbf{PA^-}$                     | Finitely axiomatized fragment of $\mathbf{PA}$ | [LO.FirstOrder.Arith.Theory.PAminus](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Arith/Theory.html#LO.FirstOrder.Arith.Theory.PAminus) | `ùêèùêÄ‚Åª` |
| $\mathbf{I}_\mathrm{open}$          | Induction of open formula                      | [LO.FirstOrder.Arith.Theory.IOpen](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Arith/Theory.html#LO.FirstOrder.Arith.Theory.IOpen) | `ùêàopen` |
| $\mathbf{I\Sigma}_n$                | Induction of $\Sigma_n$ formula                | [LO.FirstOrder.Arith.Theory.ISigma](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Arith/Theory.html#LO.FirstOrder.Arith.Theory.ISigma) | `ùêàùö∫` |
| $\mathbf{PA}$                       | Peano arithmetic                               | [LO.FirstOrder.Arith.Theory.Peano](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Arith/Theory.html#LO.FirstOrder.Arith.Theory.Peano) | `ùêèùêÄ` |

### Theorem

- [Cut-elimination](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Hauptsatz.html#LO.FirstOrder.Derivation.hauptsatz)
  ```lean
  def LO.FirstOrder.Derivation.hauptsatz
      {L : LO.FirstOrder.Language}
      [(k : ‚Ñï) ‚Üí DecidableEq (LO.FirstOrder.Language.Func L k)]
      [(k : ‚Ñï) ‚Üí DecidableEq (LO.FirstOrder.Language.Rel L k)]
      {Œî : LO.FirstOrder.Sequent L} :
      ‚ä¢¬π Œî ‚Üí { d : ‚ä¢¬π Œî // LO.FirstOrder.Derivation.CutFree d }
  ```

- [Soundness theorem](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Basic/Soundness.html#LO.FirstOrder.soundness)
  ```lean
  theorem LO.FirstOrder.soundness
      {L : LO.FirstOrder.Language}
      {T : Set (LO.FirstOrder.Sentence L)}
      {œÉ : LO.FirstOrder.Sentence L} :
      T ‚ä¢ œÉ ‚Üí T ‚ä® œÉ
  ```

- [Completeness theorem](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Completeness/Completeness.html#LO.FirstOrder.completeness)
  ```lean
  noncomputable def LO.FirstOrder.completeness
      {L : LO.FirstOrder.Language}
      {T : LO.FirstOrder.Theory L}
      {œÉ : LO.FirstOrder.Sentence L} :
      T ‚ä® œÉ ‚Üí T ‚ä¢ œÉ
  ```

- [G√∂del's first incompleteness theorem](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Incompleteness/FirstIncompleteness.html#LO.FirstOrder.Arith.first_incompleteness)
  ```lean
  theorem LO.FirstOrder.Arith.first_incompleteness
      (T : LO.FirstOrder.Theory ‚Ñí‚Çí·µ£)
      [DecidablePred T]
      [ùêÑùê™ ‚âæ T]
      [ùêèùêÄ‚Åª ‚âæ T]
      [LO.FirstOrder.Arith.SigmaOneSound T]
      [LO.FirstOrder.Theory.Computable T] :
      ¬¨LO.System.Complete T
  ```
  - [undecidable sentence](https://iehality.github.io/lean4-logic/Logic/FirstOrder/Incompleteness/FirstIncompleteness.html#LO.FirstOrder.Arith.undecidable)
    ```lean
    theorem LO.FirstOrder.Arith.undecidable
        (T : LO.FirstOrder.Theory ‚Ñí‚Çí·µ£)
        [DecidablePred T]
        [ùêÑùê™ ‚âæ T]
        [ùêèùêÄ‚Åª ‚âæ T]
        [LO.FirstOrder.Arith.SigmaOneSound T]
        [LO.FirstOrder.Theory.Computable T] :
        T ‚ä¨ LO.FirstOrder.Arith.FirstIncompleteness.undecidable T ‚àß
        T ‚ä¨ ~LO.FirstOrder.Arith.FirstIncompleteness.undecidable T
    ```

## Normal Modal Logic

### Definition

In this formalization, _(Modal) Logic_ means set of axioms.

| Logic            | Definition                    | Notation | Remarks         |
| :--------------: | ----------------------------- | :------- | --------------- |
| $\mathbf{K}$     | [LO.Modal.Normal.LogicK](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicK) | `ùêä`      |                 |
| $\mathbf{KD}$     | [LO.Modal.Normal.LogicKD](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicKD) | `ùêäùêÉ`      |                 |
| $\mathbf{S4}$    | [LO.Modal.Normal.LogicS4](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicS4) | `ùêíùüí`     | Alias of `ùêäùêìùüí`. |
| $\mathbf{S4.2}$  | [LO.Modal.Normal.LogicS4Dot2](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicS4Dot2) | `ùêíùüí.ùüê`   |                 |
| $\mathbf{S4.3}$  | [LO.Modal.Normal.LogicS4Dot3](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicS4Dot3) | `ùêíùüí.ùüë`   |                 |
| $\mathbf{S4Grz}$ | [LO.Modal.Normal.LogicS4Grz](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicS4Grz) | `ùêíùüíùêÜùê´ùê≥`  |                 |
| $\mathbf{S5}$    | [LO.Modal.Normal.LogicS5](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicS5) | `ùêíùüì`     | Alias of `ùêäùêìùüì`. |
| $\mathbf{GL}$    | [LO.Modal.Normal.LogicGL](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Logics.html#LO.Modal.Normal.LogicGL) | `ùêÜùêã`     |                 |

|                                   |                                            | Definition                                 |   Notation   |
| :-------------------------------: | ------------------------------------------ | :----------------------------------------- | :----------: |
|      $M, w \models \varphi$       | Satisfy                                    | [LO.Modal.Normal.Formula.Satisfies](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Semantics.html#LO.Modal.Normal.Formula.Satisfies) | `w ‚äß·¥πÀ¢[M] œÜ` |
|        $M \models \varphi$        | Valid on model (Models)                    | [LO.Modal.Normal.Formula.Models](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Semantics.html#LO.Modal.Normal.Formula.Models) |  `‚äß·¥π·µê[M] œÜ`  |
|        $F \models \varphi$        | Valid on frame (Frames)                    | [LO.Modal.Normal.Formula.Frames](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Semantics.html#LO.Modal.Normal.Formula.Frames) |  `‚äß·¥π·∂†[F] œÜ`  |
|    $\Gamma \models^F \varphi$     | Consequence on frame                       | [LO.Modal.Normal.Formula.FrameConsequence](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Semantics.html#LO.Modal.Normal.Formula.FrameConsequence) | `Œì ‚ä®·¥π·∂†[F] œÜ` |
| $\Gamma \vdash_{\Lambda} \varphi$ | Hilbert-style Deduction on logic $\Lambda$ | [LO.Modal.Normal.Deduction](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/HilbertStyle.html#LO.Modal.Normal.Deduction) | `Œì ‚ä¢·¥π[Œõ] œÜ`  |

### Theorem

- [Soundness of Hilbert-style deduction](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Soundness.html#LO.Modal.Normal.Logic.Hilbert.sounds) for `ùêä` extend `ùêì`, `ùêÅ`, `ùêÉ`, `ùüí`, `ùüì` Extensions (i.e. `ùêäùêÉ`, `ùêíùüí`, `ùêíùüì`, etc.)
  ```lean
  theorem LO.Modal.Normal.Logic.Hilbert.sounds
      {Œ± : Type u} [Inhabited Œ±]
      {Œ≤ : Type u} [Inhabited Œ≤]
      (Œõ : AxiomSet Œ±)
      (f : Frame Œ≤) (hf : f ‚àà (FrameClass Œ≤ Œ± Œõ))
      {p : LO.Modal.Normal.Formula Œ±}
      (h : ‚ä¢·¥π[Œõ] p) :
      ‚äß·¥π·∂†[f] p
  ```
  - [Consistency](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/Soundness.html#LO.Modal.Normal.Logic.Hilbert.consistency)
    ```lean
    theorem LO.Modal.Normal.Logic.Hilbert.consistency
        {Œ± : Type u}
        {Œ≤ : Type u}
        (Œõ : AxiomSet Œ±)
        (hf : ‚àÉ f, f ‚àà (FrameClass Œ≤ Œ± Œõ)) :
        ‚ä¨·¥π[Œõ]! ‚ä•
    ```
  -  **WIP:** Currently, these theorems was proved where only `Œõ` is `ùêä`, `ùêäùêÉ`, `ùêíùüí`, `ùêíùüì`.
- Strong Completeness of Hilbert-style deduction for `ùêä` extend `ùêì`, `ùêÅ`, `ùêÉ`, `ùüí`, `ùüì` Extensions
  ```
  def Completeness
    {Œ± Œ≤ : Type u}
    (Œõ : AxiomSet Œ≤)
    (ùîΩ : FrameClass Œ±)
    := ‚àÄ (Œì : Theory Œ≤) (p : Formula Œ≤), (Œì ‚ä®·¥π[ùîΩ] p) ‚Üí (Œì ‚ä¢·¥π[Œõ]! p)

  theorem LogicK.Hilbert.completes
    {Œ≤ : Type u} [inst‚úù : DecidableEq Œ≤] :
    Completeness
      (ùêä : AxiomSet Œ≤)
      (ùîΩ((ùêä : AxiomSet Œ≤)) : FrameClass (MaximalConsistentTheory (ùêä : AxiomSet Œ≤)))
  ```
- [G√∂del-McKensey-Tarski Theorem](https://iehality.github.io/lean4-logic/Logic/Modal/Normal/ModalCompanion.html#LO.Modal.Normal.companion_Int_S4)
  ```lean
  def GTranslation : Intuitionistic.Formula Œ± ‚Üí Formula Œ±
  postfix:75 "·µç" => GTranslation

  theorem companion_Int_S4
    [DecidableEq Œ±] [Encodable Œ±] [Inhabited Œ±]
    {p : Intuitionistic.Formula Œ≤} : (‚àÖ ‚ä¢! p) ‚Üî (‚àÖ ‚ä¢·¥π[ùêíùüí]! p·µç)
  ```

## References
- J. Han, F. van Doorn, A formalization of forcing and the unprovability of the continuum hypothesis
- W. Pohlers, Proof Theory: The First Step into Impredicativity
- P. H√°jek, P. Pudl√°k, Metamathematics of First-Order Arithmetic
- R. Kaye, Models of Peano arithmetic
- Áî∞‰∏≠ ‰∏Ä‰πã, „Ç≤„Éº„Éá„É´„Å®20‰∏ñÁ¥Ä„ÅÆË´ñÁêÜÂ≠¶
- ËèäÊ±† Ë™† (Á∑®ËÄÖ), „ÄéÊï∞Â≠¶„Å´„Åä„Åë„ÇãË®ºÊòé„Å®ÁúüÁêÜ ‚îÄ ÊßòÁõ∏Ë´ñÁêÜ„Å®Êï∞Â≠¶Âü∫Á§éË´ñ„Äè
- P. Blackburn, M. de Rijke, Y. Venema, "Modal Logic"
- Open Logic Project, ["The Open Logic Text"](https://builds.openlogicproject.org/)
- R. Hakli, S. Negri, "Does the deduction theorem fail for modal logic?"
- G. Boolos, "The Logic of Provability"
- Huayu Guo, Dongheng Chen, Bruno Bentzen, _"Verified completeness in Henkin-style for intuitionistic propositional logic"_
  - https://arxiv.org/abs/2310.01916
  - https://github.com/bbentzen/ipl
